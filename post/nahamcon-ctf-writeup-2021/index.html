<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>NahamCon CTF Writeup 2021 🐱‍💻 | NSS</title>
<meta name="description" content="Mrecho">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="https://mrecho123.github.io/favicon.ico?v=1691109685981">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://unpkg.com/papercss@1.6.1/dist/paper.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://mrecho123.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


  </head>
  <body>
  
    <nav class="navbar border fixed split-nav">
  <div class="nav-brand">
    <h3><a href="https://mrecho123.github.io">NSS</a></h3>
  </div>
  <div class="collapsible">
    <input id="collapsible1" type="checkbox" name="collapsible1">
    <button>
      <label for="collapsible1">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </label>
    </button>
    <div class="collapsible-body">
      <ul class="inline">
        
          <li>
            
              <a href="/" class="menu">
                Index
              </a>
            
          </li>
        
          <li>
            
              <a href="/archives" class="menu">
                archive
              </a>
            
          </li>
        
          <li>
            
              <a href="/tags" class="menu">
                Tag Index
              </a>
            
          </li>
        
          <li>
            
              <a href="/post/about" class="menu">
                about us
              </a>
            
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div id="top" class="row site">
      <div class="sm-12 md-8 col">
        <div class="paper">
          <article class="article">
            <h1>NahamCon CTF Writeup 2021 🐱‍💻</h1>
            <p class="article-meta">
              2021-03-13
              
                <a href="https://mrecho123.github.io/tag/VnWuWwEsW/" class="badge warning">
                  CTF
                </a>
              
            </p>
            
            <div class="post-content">
              <figure data-type="image" tabindex="1"><img src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*W-_7lDYsjx_LEwi92McTeQ.png" alt="img" loading="lazy"></figure>
<p><strong>Hello, I m Mr_echo, I m played Nahamcon CTF 2021 this weekend, and I'm gonna write some interesting challenges that I solved 👌.~Enjoy</strong></p>
<h2 id="1-homeward-bound-web-50-p">1. Homeward Bound [WEB 50 p]</h2>
<h3 id="objective"><strong>Objective</strong>:</h3>
<p><strong>-bypass 404</strong></p>
<p><a href="http://challenge.nahamcon.com:30903/">http://challenge.nahamcon.com:30903</a></p>
<ul>
<li><strong>NOTE: That message is intended. This challenge is working as it should.</strong></li>
</ul>
<p>So I tried to bypass this page by adding headers</p>
<ul>
<li>I found this awesome tool &gt;<a href="https://github.com/lobuhi/byp4xx.git">https://github.com/lobuhi/byp4xx.git</a></li>
</ul>
<blockquote>
<p>./byp4xx.sh -c <a href="http://challenge.nahamcon.com:30903/">http://challenge.nahamcon.com:30903/</a></p>
</blockquote>
<p><img src="https://cdn-images-1.medium.com/max/3152/1*hwm2V563x1_of2vPdvzDlg.png" alt="*results" loading="lazy">*<em>results</em></p>
<blockquote>
<p>curl -ki -H “X-Forwarded-For: 127.0.0.1” -X GET “<a href="http://challenge.nahamcon.com:30903//">http://challenge.nahamcon.com:30903//</a>&quot;</p>
</blockquote>
<p><img src="https://cdn-images-1.medium.com/max/3358/1*Uc_-vsG0JS7PTg2JrrJgbQ.png" alt="done" loading="lazy"><em>done</em></p>
<h2 id="2-imposter-web-500">2. Imposter [WEB 500]</h2>
<h3 id="objective-2">Objective:</h3>
<p><strong>-account take over using reset functionality<br>
-bypass 2FA<br>
-generate OTP</strong></p>
<p>Are you who you say you are? How can you be not?</p>
<ul>
<li><a href="http://challenge.nahamcon.com:31068/">http://challenge.nahamcon.com:31068</a></li>
</ul>
<p>Let's take a look at the web app</p>
<p><img src="https://cdn-images-1.medium.com/max/2446/1*nsknDSpmgwsBdttm2qdq7w.png" alt="*sign in and sign up page" loading="lazy">*<em>sign in and sign up page</em></p>
<p>Let's create a test user</p>
<figure data-type="image" tabindex="2"><img src="https://cdn-images-1.medium.com/max/2000/1*H-Nlrs16-i04O15Ghi-9-A.png" alt="" loading="lazy"></figure>
<p>Give us this QR code</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*8Kmutw53bI4MIkaNHqTojA.png" alt="otp" loading="lazy"><em>otp</em></p>
<ul>
<li>
<p><strong>Otpauth</strong></p>
</li>
<li>
<p><strong>2Password:test &lt; user</strong></p>
</li>
<li>
<p><strong>?secret=ORSXG5BRGIZTINJWG44DS [<strong>test123456789</strong>]&lt; base32 user+pass</strong></p>
</li>
<li>
<p><strong>issuer=2Password</strong></p>
</li>
</ul>
<p>Lets try to login as test user</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*ttsEHaPlS8z9KZ8pkQm-Ig.png" alt="how we can generate the 2Fa otp" loading="lazy"><em>how we can generate the 2Fa otp</em></p>
<p>so we use google auth</p>
<blockquote>
<p><em>The OTP thing is down 😦(</em>*</p>
</blockquote>
<ul>
<li>trying to reset test user pass : [test:<a href="mailto:test@cc.com">test@cc.com</a>:qerty123456] the new pass reset : hacked12345678</li>
</ul>
<figure data-type="image" tabindex="3"><img src="https://cdn-images-1.medium.com/max/2000/1*VmTGF6xOhbjNxW2PBcmlNg.png" alt="" loading="lazy"></figure>
<ul>
<li>trying to reset the password of the admin</li>
</ul>
<figure data-type="image" tabindex="4"><img src="https://cdn-images-1.medium.com/max/2000/1*KFnsN7Tvk1mmPSBLlVjbNg.png" alt="" loading="lazy"></figure>
<ul>
<li>
<p>turn out there is an injection just add “;” [your_email;admin@congon4tor.me]</p>
</li>
<li>
<p>u will get a reset URL in your email 😃)</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2958/1*JwllEp2eW4OaT4vS8eOk4w.png" alt=":)))" loading="lazy"><em>😃))</em></p>
<ul>
<li>Login as admin and get the flag 😃)</li>
</ul>
<h2 id="3-agenttester-web-500p">3. AgentTester [WEB 500p]</h2>
<h3 id="objective-3">Objective:</h3>
<ul>
<li>
<p>Sqlite3 injection</p>
</li>
<li>
<p>SSTI (server-side template injection)</p>
</li>
</ul>
<p>We’ve recently hired an entry-level web developer to build an internal system to test User Agents, let us know if you find any errors!</p>
<ul>
<li>
<p><a href="http://challenge.nahamcon.com:31047/">http://challenge.nahamcon.com:31047</a></p>
</li>
<li>
<p>agenttester.zip</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2424/1*eITBTmJ3jiE_fZBEgiYfQw.png" alt="*login page" loading="lazy">*<em>login page</em></p>
<p>Let's create a test user</p>
<p><img src="https://cdn-images-1.medium.com/max/2514/1*fZw0CYdti_PELoXrRyHxNQ.png" alt="*SQLi" loading="lazy">*<em>SQLi</em></p>
<p>Trying regular strings; nothing 😦(</p>
<p>BUT</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*w46DkxRdjIceLGSmItXiLQ.png" alt="HMMM" loading="lazy"><em>HMMM</em></p>
<p>So we have syntax error of sqlite3</p>
<ul>
<li>
<p>Using <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md</a></p>
</li>
<li>
<p>custom payload: test’ union select username, password from user where ‘1’=’1</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*LNq1xnpmR0vLmvD8J_DUww.png" alt="*yay" loading="lazy">*<em>yay</em></p>
<ul>
<li>user: admin ; pass : <code>*)([@skdnaj238374834](http://twitter.com/skdnaj238374834)**__**=</code></li>
</ul>
<p>Login as admin :</p>
<figure data-type="image" tabindex="5"><img src="https://cdn-images-1.medium.com/max/2962/1*bEzoIxuzuXbTuT5KlRj34Q.png" alt="" loading="lazy"></figure>
<p>Nothing interesting; no admin panel 😦(</p>
<p>so let's move on to the source code</p>
<p>In /app/app.py</p>
<ul>
<li>
<p>/debug dir with post request condition and id = 1</p>
</li>
<li>
<p>so we go to /debug and set id cookie to 1</p>
</li>
</ul>
<figure data-type="image" tabindex="6"><img src="https://cdn-images-1.medium.com/max/2940/1*jdAaMI_gvJeqpL0bFPoGQA.png" alt="" loading="lazy"></figure>
<ul>
<li>
<p>code = request.form.get(“code”, “<h1>Safe Debug</h1>”)<br>
return render_template_string(code)</p>
</li>
<li>
<p>lets try code=test</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2178/1*-LufItCALQK3tcXOniYfxg.png" alt="render as text" loading="lazy"><em>render as text</em></p>
<ul>
<li>
<p>“render_template_string” function kinda interesting so let's try some template payloads aka SSTI <a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#:~:text=A%20server%2Dside%20template%20injection,is%20then%20executed%20server%2Dside.&amp;text=Server%2Dside%20template%20injection%20attacks,than%20passed%20in%20as%20data.">here</a></p>
</li>
<li>
<p>sens we have flask python server <a href="https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/">here</a></p>
</li>
<li>
<p>simple payload {{7*7}} if = 49 we will try advance payloads to get rce</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2610/1*unjqmFHJ1-L-v2_p0Mk2XQ.png" alt="yay" loading="lazy"><em>yay</em></p>
<ul>
<li>advance payloads found <a href="https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/">here</a></li>
</ul>
<blockquote>
<p>payload {{request.application.<strong>globals</strong>.<strong>builtins</strong>.<strong>import</strong>(‘os’).popen(‘printenv’).read()}}</p>
</blockquote>
<p><img src="https://cdn-images-1.medium.com/max/2822/1*nPLBRyPfCM-eOxBQdnd3MQ.png" alt="RCE :))" loading="lazy"><em>RCE 😃)</em></p>
<p><em>Let us hunt the flag</em></p>
<blockquote>
<p>u will not find it anywhere on the server</p>
</blockquote>
<ul>
<li>let's come back to the giving source code</li>
</ul>
<p><em>there is a file called run.sh</em></p>
<blockquote>
<p>export CHALLENGE_NAME=”AgentTester” &amp;&amp; export CHALLENGE_FLAG=”<REDACTED>”\</p>
</blockquote>
<ul>
<li>so the flag is stored in the env</li>
</ul>
<p>we can dump it using “printenv”</p>
<p><img src="https://cdn-images-1.medium.com/max/3092/1*Kr-CIpIKXwWtc-eh_diJ3w.png" alt="yay" loading="lazy"><em>yay</em></p>
<h2 id="4-resourceful-mobile-50-p">4. Resourceful [Mobile 50 p]</h2>
<h3 id="objective-4"><strong>Objective:</strong></h3>
<ul>
<li>
<p><strong>Password stored on the source code</strong></p>
</li>
<li>
<p><strong>using<a href="https://github.com/skylot/jadx/releases/tag/v1.2.0"> jadx-gui</a></strong></p>
</li>
</ul>
<p>Running the apk file</p>
<p><img src="https://cdn-images-1.medium.com/max/2396/1*Eo9gYwt3GE7WEOIECCuEyw.png" alt="*password" loading="lazy">*<em>password</em></p>
<p>Password needed, so let us analyze this app using jadk</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*yFfyJHvU6tUsZtlHx-4Svg.png" alt="search password in the search section" loading="lazy"><em>search password in the search section</em></p>
<p>found stored password</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*Wo8p04_yeYXYkepiwDc1oQ.png" alt="yay" loading="lazy"><em>yay</em></p>
<p>we got the flag 😃)</p>
<figure data-type="image" tabindex="7"><img src="https://cdn-images-1.medium.com/max/2000/1*ceYCCx23VyjF9XdQrbNyjQ.png" alt="" loading="lazy"></figure>
<p>BTW THIS IS MY FIRST WRITEUP 😃) LIKE AND FOLLOW</p>

            </div>
          </article>
        </div>
        <div class="paper" data-aos="fade-in">
          
        </div>
        
          
            <div class="paper" data-aos="fade-in">
              <div id="gitalk-container"></div>
            </div>
          

          
        
      </div>

      <div class="sm-12 md-4 col sidebar">
  <div class="paper info-container">
    <img src="https://mrecho123.github.io/images/avatar.png?v=1691109685981" class="no-responsive avatar">
    <div class="text-muted">Mrecho</div>
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      最新文章
    </div>
    <div class="row">
      <ul>
        
          
            <li>
              <a href="https://mrecho123.github.io/post/about/">About</a>
            </li>
          
        
          
            <li>
              <a href="https://mrecho123.github.io/post/tfc-ctf-2023-web-challenges/">TFC CTF 2023 - web challenges 🐱‍💻</a>
            </li>
          
        
          
            <li>
              <a href="https://mrecho123.github.io/post/cve-2023-001/">CVE-2023-001</a>
            </li>
          
        
          
            <li>
              <a href="https://mrecho123.github.io/post/go-for-a-walk-and-brainstorm-ideas/">Go for a walk and brainstorm ideas.</a>
            </li>
          
        
          
            <li>
              <a href="https://mrecho123.github.io/post/what-is-a-bug-hunter-aka-white-hat-hackers/">Bug hunting - (BLOG STYLE)</a>
            </li>
          
        
          
            <li>
              <a href="https://mrecho123.github.io/post/what-is-mathematics/">Examples -N2 </a>
            </li>
          
        
          
            <li>
              <a href="https://mrecho123.github.io/post/nahamcon-ctf-writeup-2021/">NahamCon CTF Writeup 2021 🐱‍💻</a>
            </li>
          
        
          
            <li>
              <a href="https://mrecho123.github.io/post/hello-world/">Hello world </a>
            </li>
          
        
      </ul>
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      标签列表
    </div>
    <div class="row">
      
        <a href="https://mrecho123.github.io/tag/VnWuWwEsW/" class="badge secondary">
          CTF
        </a>
      
    </div>
  </div>
  <div class="paper">
     | <a class="rss" href="https://mrecho123.github.io/atom.xml" target="_blank">RSS</a>
  </div>
</div>


    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: 'e0f5440468948fd7a048',
        clientSecret: 'e7f6ee5cabd5203523d139a8b8b602f47f4e0cc6',
        repo: 'mrecho123.github.io',
        owner: 'mrecho123',
        admin: ['mrecho123'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
