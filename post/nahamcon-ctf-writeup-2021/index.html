<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NahamCon CTF Writeup 2021 🐱‍💻 | </title>
<link rel="shortcut icon" href="https://mrecho123.github.io/favicon.ico?v=1691193824126">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://mrecho123.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="NahamCon CTF Writeup 2021 🐱‍💻 |  - Atom Feed" href="https://mrecho123.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="Hello, I m Mr_echo, I m played Nahamcon CTF 2021 this weekend, and I'm gonna write some interesting challenges that I so..." />
    <meta name="keywords" content="CTF" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://mrecho123.github.io">
  <img class="avatar" src="https://mrecho123.github.io/images/avatar.png?v=1691193824126" alt="">
  </a>
  <h1 class="site-title">
    
  </h1>
  <p class="site-description">
    Mrecho
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          Index
        </a>
      
    
      
        <a href="/archives" class="menu">
          Archives
        </a>
      
    
      
        <a href="/tags" class="menu">
          Tags
        </a>
      
    
      
        <a href="/post/about" class="menu">
          About
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/amine123ait" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              NahamCon CTF Writeup 2021 🐱‍💻
            </h2>
            <div class="post-info">
              <span>
                2021-03-12
              </span>
              <span>
                4 min read
              </span>
              
                <a href="https://mrecho123.github.io/tag/VnWuWwEsW/" class="post-tag">
                  # CTF
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*W-_7lDYsjx_LEwi92McTeQ.png" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <p><strong>Hello, I m Mr_echo, I m played Nahamcon CTF 2021 this weekend, and I'm gonna write some interesting challenges that I solved 👌.~Enjoy</strong></p>
<h2 id="1-homeward-bound-web-50-p">1. Homeward Bound [WEB 50 p]</h2>
<h3 id="objective"><strong>Objective</strong>:</h3>
<p><strong>-bypass 404</strong></p>
<p><a href="http://challenge.nahamcon.com:30903/">http://challenge.nahamcon.com:30903</a></p>
<ul>
<li><strong>NOTE: That message is intended. This challenge is working as it should.</strong></li>
</ul>
<p>So I tried to bypass this page by adding headers</p>
<ul>
<li>I found this awesome tool &gt;<a href="https://github.com/lobuhi/byp4xx.git">https://github.com/lobuhi/byp4xx.git</a></li>
</ul>
<blockquote>
<p>./byp4xx.sh -c <a href="http://challenge.nahamcon.com:30903/">http://challenge.nahamcon.com:30903/</a></p>
</blockquote>
<p><img src="https://cdn-images-1.medium.com/max/3152/1*hwm2V563x1_of2vPdvzDlg.png" alt="*results" loading="lazy">*<em>results</em></p>
<blockquote>
<p>curl -ki -H “X-Forwarded-For: 127.0.0.1” -X GET “<a href="http://challenge.nahamcon.com:30903//">http://challenge.nahamcon.com:30903//</a>&quot;</p>
</blockquote>
<p><img src="https://cdn-images-1.medium.com/max/3358/1*Uc_-vsG0JS7PTg2JrrJgbQ.png" alt="done" loading="lazy"><em>done</em></p>
<h2 id="2-imposter-web-500">2. Imposter [WEB 500]</h2>
<h3 id="objective-2">Objective:</h3>
<p><strong>-account take over using reset functionality<br>
-bypass 2FA<br>
-generate OTP</strong></p>
<p>Are you who you say you are? How can you be not?</p>
<ul>
<li><a href="http://challenge.nahamcon.com:31068/">http://challenge.nahamcon.com:31068</a></li>
</ul>
<p>Let's take a look at the web app</p>
<p><img src="https://cdn-images-1.medium.com/max/2446/1*nsknDSpmgwsBdttm2qdq7w.png" alt="*sign in and sign up page" loading="lazy">*<em>sign in and sign up page</em></p>
<p>Let's create a test user</p>
<figure data-type="image" tabindex="1"><img src="https://cdn-images-1.medium.com/max/2000/1*H-Nlrs16-i04O15Ghi-9-A.png" alt="" loading="lazy"></figure>
<p>Give us this QR code</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*8Kmutw53bI4MIkaNHqTojA.png" alt="otp" loading="lazy"><em>otp</em></p>
<ul>
<li>
<p><strong>Otpauth</strong></p>
</li>
<li>
<p><strong>2Password:test &lt; user</strong></p>
</li>
<li>
<p><strong>?secret=ORSXG5BRGIZTINJWG44DS [<strong>test123456789</strong>]&lt; base32 user+pass</strong></p>
</li>
<li>
<p><strong>issuer=2Password</strong></p>
</li>
</ul>
<p>Lets try to login as test user</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*ttsEHaPlS8z9KZ8pkQm-Ig.png" alt="how we can generate the 2Fa otp" loading="lazy"><em>how we can generate the 2Fa otp</em></p>
<p>so we use google auth</p>
<blockquote>
<p><em>The OTP thing is down 😦(</em>*</p>
</blockquote>
<ul>
<li>trying to reset test user pass : [test:<a href="mailto:test@cc.com">test@cc.com</a>:qerty123456] the new pass reset : hacked12345678</li>
</ul>
<figure data-type="image" tabindex="2"><img src="https://cdn-images-1.medium.com/max/2000/1*VmTGF6xOhbjNxW2PBcmlNg.png" alt="" loading="lazy"></figure>
<ul>
<li>trying to reset the password of the admin</li>
</ul>
<figure data-type="image" tabindex="3"><img src="https://cdn-images-1.medium.com/max/2000/1*KFnsN7Tvk1mmPSBLlVjbNg.png" alt="" loading="lazy"></figure>
<ul>
<li>
<p>turn out there is an injection just add “;” [your_email;admin@congon4tor.me]</p>
</li>
<li>
<p>u will get a reset URL in your email 😃)</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2958/1*JwllEp2eW4OaT4vS8eOk4w.png" alt=":)))" loading="lazy"><em>😃))</em></p>
<ul>
<li>Login as admin and get the flag 😃)</li>
</ul>
<h2 id="3-agenttester-web-500p">3. AgentTester [WEB 500p]</h2>
<h3 id="objective-3">Objective:</h3>
<ul>
<li>
<p>Sqlite3 injection</p>
</li>
<li>
<p>SSTI (server-side template injection)</p>
</li>
</ul>
<p>We’ve recently hired an entry-level web developer to build an internal system to test User Agents, let us know if you find any errors!</p>
<ul>
<li>
<p><a href="http://challenge.nahamcon.com:31047/">http://challenge.nahamcon.com:31047</a></p>
</li>
<li>
<p>agenttester.zip</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2424/1*eITBTmJ3jiE_fZBEgiYfQw.png" alt="*login page" loading="lazy">*<em>login page</em></p>
<p>Let's create a test user</p>
<p><img src="https://cdn-images-1.medium.com/max/2514/1*fZw0CYdti_PELoXrRyHxNQ.png" alt="*SQLi" loading="lazy">*<em>SQLi</em></p>
<p>Trying regular strings; nothing 😦(</p>
<p>BUT</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*w46DkxRdjIceLGSmItXiLQ.png" alt="HMMM" loading="lazy"><em>HMMM</em></p>
<p>So we have syntax error of sqlite3</p>
<ul>
<li>
<p>Using <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md</a></p>
</li>
<li>
<p>custom payload: test’ union select username, password from user where ‘1’=’1</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*LNq1xnpmR0vLmvD8J_DUww.png" alt="*yay" loading="lazy">*<em>yay</em></p>
<ul>
<li>user: admin ; pass : <code>*)([@skdnaj238374834](http://twitter.com/skdnaj238374834)**__**=</code></li>
</ul>
<p>Login as admin :</p>
<figure data-type="image" tabindex="4"><img src="https://cdn-images-1.medium.com/max/2962/1*bEzoIxuzuXbTuT5KlRj34Q.png" alt="" loading="lazy"></figure>
<p>Nothing interesting; no admin panel 😦(</p>
<p>so let's move on to the source code</p>
<p>In /app/app.py</p>
<ul>
<li>
<p>/debug dir with post request condition and id = 1</p>
</li>
<li>
<p>so we go to /debug and set id cookie to 1</p>
</li>
</ul>
<figure data-type="image" tabindex="5"><img src="https://cdn-images-1.medium.com/max/2940/1*jdAaMI_gvJeqpL0bFPoGQA.png" alt="" loading="lazy"></figure>
<ul>
<li>
<p>code = request.form.get(“code”, “<h1>Safe Debug</h1>”)<br>
return render_template_string(code)</p>
</li>
<li>
<p>lets try code=test</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2178/1*-LufItCALQK3tcXOniYfxg.png" alt="render as text" loading="lazy"><em>render as text</em></p>
<ul>
<li>
<p>“render_template_string” function kinda interesting so let's try some template payloads aka SSTI <a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#:~:text=A%20server%2Dside%20template%20injection,is%20then%20executed%20server%2Dside.&amp;text=Server%2Dside%20template%20injection%20attacks,than%20passed%20in%20as%20data.">here</a></p>
</li>
<li>
<p>sens we have flask python server <a href="https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/">here</a></p>
</li>
<li>
<p>simple payload {{7*7}} if = 49 we will try advance payloads to get rce</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2610/1*unjqmFHJ1-L-v2_p0Mk2XQ.png" alt="yay" loading="lazy"><em>yay</em></p>
<ul>
<li>advance payloads found <a href="https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/">here</a></li>
</ul>
<blockquote>
<p>payload {{request.application.<strong>globals</strong>.<strong>builtins</strong>.<strong>import</strong>(‘os’).popen(‘printenv’).read()}}</p>
</blockquote>
<p><img src="https://cdn-images-1.medium.com/max/2822/1*nPLBRyPfCM-eOxBQdnd3MQ.png" alt="RCE :))" loading="lazy"><em>RCE 😃)</em></p>
<p><em>Let us hunt the flag</em></p>
<blockquote>
<p>u will not find it anywhere on the server</p>
</blockquote>
<ul>
<li>let's come back to the giving source code</li>
</ul>
<p><em>there is a file called run.sh</em></p>
<blockquote>
<p>export CHALLENGE_NAME=”AgentTester” &amp;&amp; export CHALLENGE_FLAG=”<REDACTED>”\</p>
</blockquote>
<ul>
<li>so the flag is stored in the env</li>
</ul>
<p>we can dump it using “printenv”</p>
<p><img src="https://cdn-images-1.medium.com/max/3092/1*Kr-CIpIKXwWtc-eh_diJ3w.png" alt="yay" loading="lazy"><em>yay</em></p>
<h2 id="4-resourceful-mobile-50-p">4. Resourceful [Mobile 50 p]</h2>
<h3 id="objective-4"><strong>Objective:</strong></h3>
<ul>
<li>
<p><strong>Password stored on the source code</strong></p>
</li>
<li>
<p><strong>using<a href="https://github.com/skylot/jadx/releases/tag/v1.2.0"> jadx-gui</a></strong></p>
</li>
</ul>
<p>Running the apk file</p>
<p><img src="https://cdn-images-1.medium.com/max/2396/1*Eo9gYwt3GE7WEOIECCuEyw.png" alt="*password" loading="lazy">*<em>password</em></p>
<p>Password needed, so let us analyze this app using jadk</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*yFfyJHvU6tUsZtlHx-4Svg.png" alt="search password in the search section" loading="lazy"><em>search password in the search section</em></p>
<p>found stored password</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*Wo8p04_yeYXYkepiwDc1oQ.png" alt="yay" loading="lazy"><em>yay</em></p>
<p>we got the flag 😃)</p>
<figure data-type="image" tabindex="6"><img src="https://cdn-images-1.medium.com/max/2000/1*ceYCCx23VyjF9XdQrbNyjQ.png" alt="" loading="lazy"></figure>
<p>BTW THIS IS MY FIRST WRITEUP 😃) LIKE AND FOLLOW</p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#1-homeward-bound-web-50-p">1. Homeward Bound [WEB 50 p]</a>
<ul>
<li><a href="#objective"><strong>Objective</strong>:</a></li>
</ul>
</li>
<li><a href="#2-imposter-web-500">2. Imposter [WEB 500]</a>
<ul>
<li><a href="#objective-2">Objective:</a></li>
</ul>
</li>
<li><a href="#3-agenttester-web-500p">3. AgentTester [WEB 500p]</a>
<ul>
<li><a href="#objective-3">Objective:</a></li>
</ul>
</li>
<li><a href="#4-resourceful-mobile-50-p">4. Resourceful [Mobile 50 p]</a>
<ul>
<li><a href="#objective-4"><strong>Objective:</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: 'e0f5440468948fd7a048',
    clientSecret: 'e7f6ee5cabd5203523d139a8b8b602f47f4e0cc6',
    repo: 'mrecho123.github.io',
    owner: 'mrecho123',
    admin: ['mrecho123'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  
  <a class="rss" href="https://mrecho123.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
